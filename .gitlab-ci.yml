run tests:
  stage: test
  image: python:3
  script:
    - pip install -r requirements.txt
    - pip install coverage
    - cd src
    - coverage run --source statkit -m unittest discover test
    - coverage report
    - coverage xml
  coverage: '/TOTAL.*\s([.\d]+)%/'
  artifacts:
    reports:
      coverage_report:
        coverage_format: cobertura
        path: coverage.xml

pages:
  image: python:3
  stage: deploy
  script:
  - pip3 install pdoc3
  - mkdir public
  - pdoc --config latex_math=True --html --output-dir public src/statkit
  - mv public/statkit/* public/ && rmdir public/statkit/
  artifacts:
    paths:
    - public
  only:
  - main
